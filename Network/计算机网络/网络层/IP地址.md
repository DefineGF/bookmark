### IP地址

#### 分类

##### A类地址：0

范围：1 + 7 = 8		[1, 126] : 2 <sup>7</sup> - 2；

不含 0， 127



##### B类地址：10

范围：2 + 6 + 8  = 16		[128.1，191.255]：2<sup>14</sup> - 1

不含 128.0



##### C类地址：110

范围：3 + 5 + 16 = 24 	[192.0.1,	223.255.255]：2<sup>21</sup> - 1

不含 192.0.0



##### 特殊IP地址

- 主机号全为0：表网络本身；
- 32b全为 0：本网络上的本主机
- 主机号全为1：又称子网的广播地址；
- 32b全为1：整个TCP/IP 网络的IP地址（又称受限广播地址），路由器可以屏蔽之

- 127.0.0.0：环路自检



##### 私有地址网段

不可用于WAN，可被LAN重复使用：

- A：一个A类 10.0.0 - 10.255.255.255
- B：16个B类 172.16.0.0 - 172.31.255.255
- C：256个C类 192.168.0.0 - 192.168.255.255



#### NAT

将私有IP地址 映射成 合法的全球IP地址

在因特网中，所有路由器对目的地址为私有地址的数据报一律丢弃；

采用私有IP地址的互联网称为专用互联网 或者 本地 互联网；

##### NAT工作过程

普通路由器转发IP数据报时，不改变其源IP地址和目的IP地址，仅工作在网络层；

而NAT路由器不仅改变其IP地址，且转换传输层的端口号；

NAT转换表：

WAN 端								LAN端

138.76.29.7:5001			192.168.0.2:2233

138.76.29.7:5002			192.168.0.3:1234



#### 子网划分 & 子网掩码

##### 子网划分

只是把IP地址主机号进行再划分；一个IP地址本身或者IP数据报首部，无法判断是否进行过子网划分；

子网网络号：主机号全为0

广播地址：主机号全为1



##### 子网掩码

现在的因特网标准：所有网络必须使用子网掩码；

A类默认：255.0.0.0

B类默认：255.255.0.0

C类默认：255.255.255.0



注意事项：

- 同属同一子网时：所有主机和路由器相应的端口，须设相同的子网掩码；

- 路由表项：目的网络地址 & 子网掩码 & 下一跳地址

    分组首部目的IP地址 D

    1. 直接交付：与路由器直接相连的网络逐个检查各子网掩码 & D 是否匹配；

    2. 特定主机路由：指明下一跳路由器；
    3. 与路由表中各行的子网掩码相 & 比较，结果再和 目的网络比较，取最长匹配者转发；
    4. 默认路由：0.0.0.0 & 0.0.0.0 = 0.0.0.0
    5. 出错

    