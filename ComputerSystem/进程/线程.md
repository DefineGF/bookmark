#### 线程

cpu执行单元；独立调度；

通信：全局变量；

组成：线程ID，程序计数器，寄存器集合，堆栈

##### 创建过程

1. 分配PCB；否则失败；
2. 分配资源；否则阻塞；
3. 分配时间片；否则就绪；

##### 切换

- 保存上下文PC，相关寄存器；
- 更新PCB -> 队列（就绪、阻塞）
- 切换
- 恢复上下文





##### 用户级线程

把整个线程包放在用户空间中，内核对线程一无所知；即用户线程可以在不支持线程的操作系统上实现；

与进程区别：

- 线程完成时，先把线程信息（PC，堆栈指针寄存器，状态等）保存在线程表中（线程控制块），进而调用线程调度程序选择另一线程（本地）；无需陷入内核，不需要 上下文切换；
- 每个进程可独立定制自己的调度算法；
- 缺点：一个线程被阻塞，整个进程被阻塞；



##### 内核级线程

线程表保存了每个线程的寄存器、状态和其他信息在内核中；

当一个线程阻塞时，内核根据其选择，可以运行同一进程的另一个线程，也可以运行另一进程中的线程



不同进程调用的系统线程是相同的线程；